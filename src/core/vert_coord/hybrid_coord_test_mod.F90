module hybrid_coord_test_mod

  use flogger
  use const_mod
  use process_mod
  use mesh_mod

  implicit none

  private

  public hybrid_coord_test_l15
  public hybrid_coord_test_l26
  public hybrid_coord_test_l30
  public hybrid_coord_wrf_l32
  public hybrid_coord_wrf_l64

contains

  subroutine hybrid_coord_test_l15(p0, ptop, hyai, hybi)

    real(r8), intent(out) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(16)
    real(r8), intent(out) :: hybi(16)

    hyai = [0.20540233  , & !  1
            0.19853043  , & !  2
            0.19095544  , & !  3
            0.18262359  , & !  4
            0.17347834  , & !  5
            0.16346029  , & !  6
            0.15250707  , & !  7
            0.14055334  , & !  8
            0.12753061  , & !  9
            0.11336724  , & !  10
            0.09798832  , & !  11
            0.08131559  , & !  12
            0.06326738  , & !  13
            0.04375850  , & !  14
            0.02270019  , & !  15
            0.00000000]     !  16
    hybi = [0.00000     , & !  1
            0.03345579  , & !  2
            0.07033459  , & !  3
            0.11089815  , & !  4
            0.15542174  , & !  5
            0.20419459  , & !  6
            0.25752023  , & !  7
            0.31571693  , & !  8
            0.37911800  , & !  9
            0.44807228  , & !  10
            0.52294448  , & !  11
            0.60411556  , & !  12
            0.69198316  , & !  13
            0.78696201  , & !  14
            0.88948427  , & !  15
            1.00000000]     !  16

    p0 = 1d5 ! Pa
    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_test_l15

  subroutine hybrid_coord_test_l26(p0, ptop, hyai, hybi)

    real(r8), intent(out) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(27)
    real(r8), intent(out) :: hybi(27)

    hyai = [0.002194067  , & !  1
            0.004895209  , & !  2
            0.009882418  , & !  3
            0.01805201   , & !  4
            0.02983724   , & !  5
            0.04462334   , & !  6
            0.06160587   , & !  7
            0.07851243   , & !  8
            0.07731271   , & !  9
            0.07590131   , & ! 10
            0.07424086   , & ! 11
            0.07228744   , & ! 12
            0.06998933   , & ! 13
            0.06728574   , & ! 14
            0.06410509   , & ! 15
            0.06036322   , & ! 16
            0.05596111   , & ! 17
            0.05078225   , & ! 18
            0.04468960   , & ! 19
            0.03752191   , & ! 20
            0.02908949   , & ! 21
            0.02084739   , & ! 22
            0.01334443   , & ! 23
            0.00708499   , & ! 24
            0.00252136   , & ! 25
            0.00000000   , & ! 26
            0.00000000]      ! 27

    hybi = [0.000000     , & !  1
            0.000000     , & !  2
            0.000000     , & !  3
            0.000000     , & !  4
            0.000000     , & !  5
            0.000000     , & !  6
            0.000000     , & !  7
            0.000000     , & !  8
            0.01505309   , & !  9
            0.03276228   , & ! 10
            0.05359622   , & ! 11
            0.07810627   , & ! 12
            0.1069411    , & ! 13
            0.1408637    , & ! 14
            0.1807720    , & ! 15
            0.2277220    , & ! 16
            0.2829562    , & ! 17
            0.3479364    , & ! 18
            0.4243822    , & ! 19
            0.5143168    , & ! 20
            0.6201202    , & ! 21
            0.7235355    , & ! 22
            0.8176768    , & ! 23
            0.8962153    , & ! 24
            0.9534761    , & ! 25
            0.9851122    , & ! 26
            1.0000000]       ! 27

    p0 = 1d5 ! Pa
    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_test_l26

  subroutine hybrid_coord_test_l30(p0, ptop, hyai, hybi)

    real(r8), intent(out) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(31)
    real(r8), intent(out) :: hybi(31)

    hyai = [0.20540233  , & !  1
            0.20205101  , & !  2
            0.19853043  , & !  3
            0.19483412  , & !  4
            0.19095544  , & !  5
            0.18688759  , & !  6
            0.18262359  , & !  7
            0.17815629  , & !  8
            0.17347834  , & !  9
            0.16858224  , & !  10
            0.16346029  , & !  11
            0.15810459  , & !  12
            0.15250707  , & !  13
            0.14665948  , & !  14
            0.14055334  , & !  15
            0.13418     , & !  16
            0.12753061  , & !  17
            0.12059611  , & !  18
            0.11336724  , & !  19
            0.10583453  , & !  20
            0.09798832  , & !  21
            0.0898187   , & !  22
            0.08131559  , & !  23
            0.07246866  , & !  24
            0.06326738  , & !  25
            0.05370098  , & !  26
            0.0437585   , & !  27
            0.03342871  , & !  28
            0.02270019  , & !  29
            0.01156125  , & !  30
            0.00000000]     !  31

    hybi = [0.00000     , & !  1
            0.01631585  , & !  2
            0.03345579  , & !  3
            0.05145127  , & !  4
            0.07033459  , & !  5
            0.09013889  , & !  6
            0.11089815  , & !  7
            0.13264719  , & !  8
            0.15542174  , & !  9
            0.17925837  , & !  10
            0.20419459  , & !  11
            0.23026877  , & !  12
            0.25752023  , & !  13
            0.28598922  , & !  14
            0.31571693  , & !  15
            0.34674548  , & !  16
            0.37911800  , & !  17
            0.41287857  , & !  18
            0.44807228  , & !  19
            0.48474521  , & !  20
            0.52294448  , & !  21
            0.56271820  , & !  22
            0.60411556  , & !  23
            0.64718678  , & !  24
            0.69198316  , & !  25
            0.73855571  , & !  26
            0.78696201  , & !  27
            0.83725251  , & !  28
            0.88948427  , & !  29
            0.94371412  , & !  30
            1.00000000]     !  31

    p0 = 1d5 ! Pa
    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_test_l30

  subroutine hybrid_coord_wrf_l32(p0, ptop, hyai, hybi)

    real(r8), intent(out) :: p0
    real(r8), intent(in ) :: ptop
    real(r8), intent(out) :: hyai(33)
    real(r8), intent(out) :: hybi(33)

    if (global_mesh%num_full_lev /= 32 .and. is_root_proc()) then
      call log_error('num_lev should be 32 in namelist!')
    end if

    hyai = [          &
      0.00000000e+00, & !  1
      3.12500000e-02, & !  2
      6.25000000e-02, & !  3
      9.37500000e-02, & !  4
      1.25000000e-01, & !  5
      1.56250000e-01, & !  6
      1.87500000e-01, & !  7
      2.17556953e-01, & !  8
      2.41699219e-01, & !  9
      2.59814262e-01, & ! 10
      2.72331238e-01, & ! 11
      2.79679298e-01, & ! 12
      2.82287598e-01, & ! 13
      2.80585289e-01, & ! 14
      2.75001526e-01, & ! 15
      2.65965462e-01, & ! 16
      2.53906250e-01, & ! 17
      2.39253044e-01, & ! 18
      2.22434998e-01, & ! 19
      2.03881264e-01, & ! 20
      1.84020996e-01, & ! 21
      1.63283348e-01, & ! 22
      1.42097473e-01, & ! 23
      1.20892525e-01, & ! 24
      1.00097656e-01, & ! 25
      8.01420212e-02, & ! 26
      6.14547729e-02, & ! 27
      4.44650650e-02, & ! 28
      2.96020508e-02, & ! 29
      1.72948837e-02, & ! 30
      7.97271729e-03, & ! 31
      2.06470490e-03, & ! 32
      4.44089210e-16  & ! 33
    ]
    hybi = [          &
      0.00000000e+00, & !  1
      0.00000000e+00, & !  2
      0.00000000e+00, & !  3
      0.00000000e+00, & !  4
      0.00000000e+00, & !  5
      0.00000000e+00, & !  6
      0.00000000e+00, & !  7
      1.19304657e-03, & !  8
      8.30078125e-03, & !  9
      2.14357376e-02, & ! 10
      4.01687622e-02, & ! 11
      6.40707016e-02, & ! 12
      9.27124023e-02, & ! 13
      1.25664711e-01, & ! 14
      1.62498474e-01, & ! 15
      2.02784538e-01, & ! 16
      2.46093750e-01, & ! 17
      2.91996956e-01, & ! 18
      3.40065002e-01, & ! 19
      3.89868736e-01, & ! 20
      4.40979004e-01, & ! 21
      4.92966652e-01, & ! 22
      5.45402527e-01, & ! 23
      5.97857475e-01, & ! 24
      6.49902344e-01, & ! 25
      7.01107979e-01, & ! 26
      7.51045227e-01, & ! 27
      7.99284935e-01, & ! 28
      8.45397949e-01, & ! 29
      8.88955116e-01, & ! 30
      9.29527283e-01, & ! 31
      9.66685295e-01, & ! 32
      1.00000000e+00  & ! 33
    ]

    p0 = 1d5       ! Pa

  end subroutine hybrid_coord_wrf_l32

  subroutine hybrid_coord_wrf_l64(p0, ptop, hyai, hybi)

    real(r8), intent(out) :: p0
    real(r8), intent(in ) :: ptop
    real(r8), intent(out) :: hyai(65)
    real(r8), intent(out) :: hybi(65)

    if (global_mesh%num_full_lev /= 64 .and. is_root_proc()) then
      call log_error('num_lev should be 64 in namelist!')
    end if

    hyai = [          &
      0.00000000e+00, & !  1
      1.56250000e-02, & !  2
      3.12500000e-02, & !  3
      4.68750000e-02, & !  4
      6.25000000e-02, & !  5
      7.81250000e-02, & !  6
      9.37500000e-02, & !  7
      1.09375000e-01, & !  8
      1.25000000e-01, & !  9
      1.40625000e-01, & !  10
      1.56250000e-01, & !  11
      1.71875000e-01, & !  12
      1.87500000e-01, & !  13
      2.03091502e-01, & !  14
      2.17556953e-01, & !  15
      2.30408311e-01, & !  16
      2.41699219e-01, & !  17
      2.51483321e-01, & !  18
      2.59814262e-01, & !  19
      2.66745687e-01, & !  20
      2.72331238e-01, & !  21
      2.76624560e-01, & !  22
      2.79679298e-01, & !  23
      2.81549096e-01, & !  24
      2.82287598e-01, & !  25
      2.81948447e-01, & !  26
      2.80585289e-01, & !  27
      2.78251767e-01, & !  28
      2.75001526e-01, & !  29
      2.70888209e-01, & !  30
      2.65965462e-01, & !  31
      2.60286927e-01, & !  32
      2.53906250e-01, & !  33
      2.46877074e-01, & !  34
      2.39253044e-01, & !  35
      2.31087804e-01, & !  36
      2.22434998e-01, & !  37
      2.13348269e-01, & !  38
      2.03881264e-01, & !  39
      1.94087625e-01, & !  40
      1.84020996e-01, & !  41
      1.73735023e-01, & !  42
      1.63283348e-01, & !  43
      1.52719617e-01, & !  44
      1.42097473e-01, & !  45
      1.31470561e-01, & !  46
      1.20892525e-01, & !  47
      1.10417008e-01, & !  48
      1.00097656e-01, & !  49
      8.99881124e-02, & !  50
      8.01420212e-02, & !  51
      7.06130266e-02, & !  52
      6.14547729e-02, & !  53
      5.27209044e-02, & !  54
      4.44650650e-02, & !  55
      3.67408991e-02, & !  56
      2.96020508e-02, & !  57
      2.31021643e-02, & !  58
      1.72948837e-02, & !  59
      1.22338533e-02, & !  60
      7.97271729e-03, & !  61
      4.56511974e-03, & !  62
      2.06470490e-03, & !  63
      5.25116920e-04, & !  64
      4.44089210e-16  & !  65
    ]
    hybi = [          &
      0.00000000e+00, & !  1
      0.00000000e+00, & !  2
      0.00000000e+00, & !  3
      0.00000000e+00, & !  4
      0.00000000e+00, & !  5
      0.00000000e+00, & !  6
      0.00000000e+00, & !  7
      0.00000000e+00, & !  8
      0.00000000e+00, & !  9
      0.00000000e+00, & !  10
      0.00000000e+00, & !  11
      0.00000000e+00, & !  12
      0.00000000e+00, & !  13
      3.34978104e-05, & !  14
      1.19304657e-03, & !  15
      3.96668911e-03, & !  16
      8.30078125e-03, & !  17
      1.41416788e-02, & !  18
      2.14357376e-02, & !  19
      3.01293135e-02, & !  20
      4.01687622e-02, & !  21
      5.15004396e-02, & !  22
      6.40707016e-02, & !  23
      7.78259039e-02, & !  24
      9.27124023e-02, & !  25
      1.08676553e-01, & !  26
      1.25664711e-01, & !  27
      1.43623233e-01, & !  28
      1.62498474e-01, & !  29
      1.82236791e-01, & !  30
      2.02784538e-01, & !  31
      2.24088073e-01, & !  32
      2.46093750e-01, & !  33
      2.68747926e-01, & !  34
      2.91996956e-01, & !  35
      3.15787196e-01, & !  36
      3.40065002e-01, & !  37
      3.64776731e-01, & !  38
      3.89868736e-01, & !  39
      4.15287375e-01, & !  40
      4.40979004e-01, & !  41
      4.66889977e-01, & !  42
      4.92966652e-01, & !  43
      5.19155383e-01, & !  44
      5.45402527e-01, & !  45
      5.71654439e-01, & !  46
      5.97857475e-01, & !  47
      6.23957992e-01, & !  48
      6.49902344e-01, & !  49
      6.75636888e-01, & !  50
      7.01107979e-01, & !  51
      7.26261973e-01, & !  52
      7.51045227e-01, & !  53
      7.75404096e-01, & !  54
      7.99284935e-01, & !  55
      8.22634101e-01, & !  56
      8.45397949e-01, & !  57
      8.67522836e-01, & !  58
      8.88955116e-01, & !  59
      9.09641147e-01, & !  60
      9.29527283e-01, & !  61
      9.48559880e-01, & !  62
      9.66685295e-01, & !  63
      9.83849883e-01, & !  64
      1.00000000e+00  & !  65
    ]

    p0 = 1d5       ! Pa

  end subroutine hybrid_coord_wrf_l64

end module hybrid_coord_test_mod
